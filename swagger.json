{
  "openapi" : "3.0.0",
  "info" : {
    "description" : "Este es un servidor de transacciones de pagos.",
    "version" : "1.0.0",
    "title" : "Sistema de pago de facturas",
    "license" : {
      "name" : "Apache 2.0",
      "url" : "http://www.apache.org/licenses/LICENSE-2.0.html"
    }
  },
  "servers" : [ {
    "description" : "Servicio de pagos por API REST",
    "url" : "http://localhost:8080/SistemaPagos/v1.0.0"
  } ],
  "paths" : {
    "/factura" : {
      "get" : {
        "description" : "Devuelve la información de la factura a pagar.",
        "tags" : [ "Factura" ],
        "summary" : "Devuelve factura a pagar.",
        "operationId" : "obtenerFactura",
        "parameters" : [ {
          "name" : "numeroFactura",
          "in" : "query",
          "description" : "Número de la factura a pagar.",
          "required" : true,
          "schema" : {
            "type" : "integer",
            "format" : "int64"
          },
          "example" : 1293863
        } ],
        "responses" : {
          "200" : {
            "description" : "Factura encontrada.",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Factura"
                }
              },
              "application/xml" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Factura"
                }
              }
            }
          },
          "400" : {
            "description" : "Factura inválida."
          },
          "404" : {
            "description" : "Factura no encontrada."
          },
          "500" : {
            "description" : "Error en el procesamiento de la petición."
          }
        }
      }
    },
    "/factura/pagar" : {
      "post" : {
        "description" : "Paga una factura con los valores especificados.",
        "tags" : [ "Factura" ],
        "summary" : "Paga una factura.",
        "operationId" : "pagarFactura",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/FacturaPago"
        },
        "responses" : {
          "200" : {
            "description" : "Pago realizado."
          },
          "400" : {
            "description" : "Entrada inválida."
          },
          "404" : {
            "description" : "Factura no encontrada."
          },
          "500" : {
            "description" : "Error en el procesamiento de la petición."
          }
        }
      }
    },
    "/factura/compensar" : {
      "post" : {
        "description" : "Permite reversar un pago.",
        "tags" : [ "Factura" ],
        "summary" : "Realizar la compensación de una factura, reversando el pago de la misma.",
        "operationId" : "compensarFactura",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/FacturaPago"
        },
        "responses" : {
          "200" : {
            "description" : "Compensación realizada."
          },
          "400" : {
            "description" : "Entrada inválida."
          },
          "404" : {
            "description" : "Factura no encontrada."
          },
          "500" : {
            "description" : "Error en el procesamiento de la petición."
          }
        }
      }
    },
    "/cuenta" : {
      "get" : {
        "description" : "Obtiene la información de la cuenta indicada.",
        "tags" : [ "Cuenta" ],
        "summary" : "Consulta de una cuenta.",
        "operationId" : "obtenerCuenta",
        "parameters" : [ {
          "name" : "numeroCuenta",
          "in" : "query",
          "description" : "Número de cuenta.",
          "required" : true,
          "schema" : {
            "type" : "integer",
            "format" : "int64"
          }
        } ],
        "responses" : {
          "200" : {
            "description" : "Cuenta encontrada.",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Cuenta"
                }
              },
              "application/xml" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Cuenta"
                }
              }
            }
          },
          "400" : {
            "description" : "Cuenta inválida."
          },
          "404" : {
            "description" : "Cuenta no encontrada."
          },
          "500" : {
            "description" : "Error en el procesamiento de la petición."
          }
        }
      }
    },
    "/cuenta/procesar" : {
      "post" : {
        "description" : "Descuenta el monto de una factura de la cuenta indicada.",
        "tags" : [ "Cuenta" ],
        "summary" : "Procesa un pago.",
        "operationId" : "debitoCuenta",
        "requestBody" : {
          "$ref" : "#/components/requestBodies/CuentaPago"
        },
        "responses" : {
          "200" : {
            "description" : "Debito realizado.",
            "content" : {
              "application/json" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Cuenta"
                }
              },
              "application/xml" : {
                "schema" : {
                  "$ref" : "#/components/schemas/Cuenta"
                }
              }
            }
          },
          "400" : {
            "description" : "Error en procesamiento del pago."
          },
          "404" : {
            "description" : "Cuenta no encontrada."
          },
          "500" : {
            "description" : "Error en el procesamiento de la petición."
          }
        }
      }
    }
  },
  "components" : {
    "schemas" : {
      "Cuenta" : {
        "type" : "object",
        "required" : [ "id" ],
        "properties" : {
          "id" : {
            "type" : "integer",
            "format" : "int64"
          },
          "saldo" : {
            "type" : "number",
            "format" : "double",
            "pattern" : "^-?[0-9]+(\\.[0-9]+)?$",
            "minLength" : 3,
            "maxLength" : 20
          },
          "estado" : {
            "type" : "string",
            "description" : "Estado de la cuenta.",
            "enum" : [ "Activa", "Inactiva" ]
          }
        },
        "xml" : {
          "name" : "Cuenta"
        }
      },
      "Factura" : {
        "type" : "object",
        "required" : [ "id" ],
        "properties" : {
          "id" : {
            "type" : "integer",
            "format" : "int64"
          },
          "monto" : {
            "type" : "number",
            "format" : "double",
            "pattern" : "^-?[0-9]+(\\.[0-9]+)?$",
            "minLength" : 3,
            "maxLength" : 20
          },
          "estado" : {
            "type" : "string",
            "description" : "Estado de la factura a pagar.",
            "enum" : [ "PAGADO", "CONCILIADO" ]
          },
          "operacion" : {
            "type" : "string",
            "description" : "Operación a realizar con la factura, puede ser de pago o de conciliación. Solo puede usarse una de las dos opciones y esta determina que función del API debería usarse. Otro valor diferente genera un error en la operación.",
            "enum" : [ "PAGAR", "CONCILIAR" ]
          }
        },
        "xml" : {
          "name" : "Factura"
        }
      },
      "Orden" : {
        "description" : "Orden de un producto, que contiene la información de transporte, hospedaje y el evento al cual asistirá el cliente de Toures Balon.",
        "type" : "object",
        "required" : [ "id" ],
        "properties" : {
          "id" : {
            "type" : "integer",
            "format" : "int64"
          },
          "transporte" : {
            "$ref" : "#/components/schemas/Transporte"
          },
          "hospedaje" : {
            "$ref" : "#/components/schemas/Hospedaje"
          },
          "evento" : {
            "$ref" : "#/components/schemas/Evento"
          }
        }
      },
      "Transporte" : {
        "description" : "Este objeto tiene la estructura básica de la información necesaria para identificar el transporte a usar por el cliente.",
        "type" : "object",
        "properties" : {
          "fecha" : {
            "type" : "string",
            "format" : "date"
          },
          "id" : {
            "type" : "string",
            "readOnly" : true
          },
          "puesto" : {
            "type" : "string"
          },
          "tipo" : {
            "type" : "string",
            "description" : "Tipo de transporte.",
            "enum" : [ "Avion", "Bus", "Tren", "Crucero" ]
          },
          "trayecto" : {
            "type" : "array",
            "items" : {
              "$ref" : "#/components/schemas/Trayecto"
            }
          }
        }
      },
      "Hospedaje" : {
        "description" : "Este objeto tiene la información necesaria para identificar el hospedaje a usar por el cliente.",
        "type" : "object",
        "properties" : {
          "id" : {
            "type" : "string",
            "readOnly" : true
          },
          "fechaLlegada" : {
            "type" : "string",
            "format" : "date"
          },
          "fechaSalida" : {
            "type" : "string",
            "format" : "date"
          },
          "habitacion" : {
            "type" : "string"
          },
          "ubicacion" : {
            "$ref" : "#/components/schemas/UbicacionGeografica"
          }
        }
      },
      "Evento" : {
        "description" : "Contiene la información del evento al cual es cliente asistirá.",
        "type" : "object",
        "properties" : {
          "id" : {
            "type" : "string",
            "readOnly" : true
          },
          "fecha" : {
            "type" : "string",
            "format" : "date"
          },
          "ubicacionEvento" : {
            "type" : "string"
          },
          "destino" : {
            "$ref" : "#/components/schemas/UbicacionGeografica"
          }
        }
      },
      "UbicacionGeografica" : {
        "description" : "Ubicación geográfica",
        "type" : "object",
        "properties" : {
          "latitud" : {
            "type" : "number",
            "format" : "float"
          },
          "longitud" : {
            "type" : "number",
            "format" : "float"
          },
          "detalle" : {
            "description" : "Indica la dirección física de un sitio",
            "type" : "string"
          },
          "pais" : {
            "type" : "object",
            "properties" : {
              "nombre" : {
                "type" : "string"
              },
              "codigo" : {
                "type" : "integer"
              },
              "ciudad" : {
                "type" : "object",
                "properties" : {
                  "nombre" : {
                    "type" : "string"
                  },
                  "codigo" : {
                    "type" : "integer"
                  },
                  "localidad" : {
                    "type" : "object",
                    "properties" : {
                      "nombre" : {
                        "type" : "string"
                      },
                      "codigo" : {
                        "type" : "integer"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "Trayecto" : {
        "description" : "indica los puntos de inicio y fin de un trayecto",
        "type" : "object",
        "properties" : {
          "origen" : {
            "$ref" : "#/components/schemas/UbicacionGeografica"
          },
          "destino" : {
            "$ref" : "#/components/schemas/UbicacionGeografica"
          }
        }
      }
    },
    "requestBodies" : {
      "FacturaConsulta" : {
        "description" : "Request con solo la referencia de la factura.",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "required" : [ "id" ],
              "properties" : {
                "id" : {
                  "type" : "integer",
                  "format" : "int64",
                  "example" : 123456789
                }
              }
            }
          },
          "application/xml" : {
            "schema" : {
              "type" : "object",
              "required" : [ "id" ],
              "properties" : {
                "id" : {
                  "type" : "integer",
                  "format" : "int64",
                  "example" : 123456789
                }
              }
            }
          }
        }
      },
      "FacturaPago" : {
        "description" : "Request con solo la información de la referencia de la factura y el valor.",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "required" : [ "id", "monto" ],
              "properties" : {
                "id" : {
                  "type" : "integer",
                  "format" : "int64",
                  "example" : 123456789
                },
                "monto" : {
                  "type" : "number",
                  "format" : "double",
                  "example" : 150000.0,
                  "pattern" : "^-?[0-9]+(\\.[0-9]+)?$",
                  "minLength" : 3,
                  "maxLength" : 20
                }
              }
            }
          },
          "application/xml" : {
            "schema" : {
              "type" : "object",
              "required" : [ "id", "monto" ],
              "properties" : {
                "id" : {
                  "type" : "integer",
                  "format" : "int64",
                  "example" : 123456789
                },
                "monto" : {
                  "type" : "number",
                  "format" : "double",
                  "example" : 150000.0,
                  "pattern" : "^-?[0-9]+(\\.[0-9]+)?$",
                  "minLength" : 3,
                  "maxLength" : 20
                }
              }
            }
          }
        }
      },
      "CuentaPago" : {
        "description" : "Request con solo la información de numero y saldode la cuenta.",
        "content" : {
          "application/json" : {
            "schema" : {
              "type" : "object",
              "required" : [ "id", "monto" ],
              "properties" : {
                "id" : {
                  "type" : "integer",
                  "format" : "int64",
                  "example" : 123456789
                },
                "saldo" : {
                  "type" : "number",
                  "format" : "double",
                  "example" : 150000.0,
                  "pattern" : "^-?[0-9]+(\\.[0-9]+)?$",
                  "minLength" : 3,
                  "maxLength" : 20
                }
              }
            }
          },
          "application/xml" : {
            "schema" : {
              "type" : "object",
              "required" : [ "id", "monto" ],
              "properties" : {
                "id" : {
                  "type" : "integer",
                  "format" : "int64",
                  "example" : 123456789
                },
                "saldo" : {
                  "type" : "number",
                  "format" : "double",
                  "example" : 150000.0,
                  "pattern" : "^-?[0-9]+(\\.[0-9]+)?$",
                  "minLength" : 3,
                  "maxLength" : 20
                }
              }
            }
          }
        }
      }
    }
  }
}